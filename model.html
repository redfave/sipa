
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Model &#8212; Sipa 1.1.0-37-g1903ba8 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="sipa" href="ref/modules.html" />
    <link rel="prev" title="Backends (Flask extension)" href="backends.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="model">
<h1>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="ref/sipa.model.html#module-sipa.model" title="sipa.model"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sipa.model</span></code></a> package mainly contains:</p>
<ol class="arabic simple">
<li><code class="xref py py-class docutils literal notranslate"><span class="pre">Datasource</span></code> implementations for the
<a class="reference internal" href="ref/sipa.backends.html#module-sipa.backends" title="sipa.backends"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sipa.backends</span></code></a> extension and everything that comes with it
(such as database setups)</li>
<li>An abstract <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseUser</span></code> class which defines all the properties a
backend’s user should provide.</li>
<li>Related to the second, a smart property-like type which is able to express
whether a particular property is “supported” or not and whether it allows
for editing and / or deleting.</li>
</ol>
<div class="section" id="implemented-backends">
<h2>Implemented backends<a class="headerlink" href="#implemented-backends" title="Permalink to this headline">¶</a></h2>
<p>Sipa registers the following datasources:</p>
<dl class="data">
<dt>
<code class="descclassname">sipa.model.</code><code class="descname">AVAILABLE_DATASOURCES</code><em class="property"> = [&lt;DataSource 'sample'&gt;, &lt;DataSource 'hss'&gt;, &lt;DataSource 'pycroft'&gt;]</em></dt>
<dd><p>The implemented datasources available by default</p>
</dd></dl>

<p>Their implementations are in the corresponding modules</p>
<ul class="simple">
<li><a class="reference internal" href="ref/sipa.model.hss.html#module-sipa.model.hss" title="sipa.model.hss"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sipa.model.hss</span></code></a></li>
<li><a class="reference internal" href="ref/sipa.model.pycroft.html#module-sipa.model.pycroft" title="sipa.model.pycroft"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sipa.model.pycroft</span></code></a></li>
<li><a class="reference internal" href="ref/sipa.model.sample.html#module-sipa.model.sample" title="sipa.model.sample"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sipa.model.sample</span></code></a></li>
</ul>
</div>
<div class="section" id="user">
<h2>User<a class="headerlink" href="#user" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">sipa.model.user.</code><code class="descname">BaseUser</code></dt>
<dd></dd></dl>

</div>
<div class="section" id="fancy-property">
<h2><cite>.fancy_property</cite><a class="headerlink" href="#fancy-property" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt>
<code class="descclassname">sipa.model.fancy_property.</code><code class="descname">Capabilities</code></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">sipa.model.fancy_property.capabilities</span></code></p>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">sipa.model.fancy_property.</code><code class="descname">PropertyBase</code><span class="sig-paren">(</span><em>name</em>, <em>value</em>, <em>raw_value</em>, <em>capabilities=capabilities(edit=False</em>, <em>delete=False)</em>, <em>style=None</em>, <em>empty=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#PropertyBase"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">supported</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">sipa.model.fancy_property.</code><code class="descname">UnsupportedProperty</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#UnsupportedProperty"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">supported</code><em class="property"> = False</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">sipa.model.fancy_property.</code><code class="descname">ActiveProperty</code><span class="sig-paren">(</span><em>name</em>, <em>value=None</em>, <em>raw_value=None</em>, <em>capabilities=capabilities(edit=False</em>, <em>delete=False)</em>, <em>style=None</em>, <em>empty=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#ActiveProperty"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">supported</code><em class="property"> = True</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">sipa.model.fancy_property.</code><code class="descname">unsupported_prop</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#unsupported_prop"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">sipa.model.fancy_property.</code><code class="descname">active_prop</code><span class="sig-paren">(</span><em>fget</em>, <em>fset=None</em>, <em>fdel=None</em>, <em>doc=None</em>, <em>fake_setter=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#active_prop"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A property-like class wrapping the getter with
<a class="reference internal" href="ref/sipa.model.html#sipa.model.fancy_property.ActiveProperty" title="sipa.model.fancy_property.ActiveProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActiveProperty</span></code></a></p>
<p><a class="reference internal" href="ref/sipa.model.html#sipa.model.fancy_property.active_prop" title="sipa.model.fancy_property.active_prop"><code class="xref py py-class docutils literal notranslate"><span class="pre">active_prop</span></code></a> automatically adds <cite>edit</cite> and <cite>delete</cite>
capabilities to the ActiveProperty object if <cite>setter</cite>/<cite>deleter</cite> is
invoked.</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">User</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nd">@active_prop</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s2">&quot;Empty!!&quot;</span><span class="p">,</span> <span class="s1">&#39;empty&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;danger&#39;</span><span class="p">}</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="nd">@active_prop</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">0</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="nd">@bar</span><span class="o">.</span><span class="n">setter</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;furiously setting things&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">User</span><span class="p">()</span><span class="o">.</span><span class="n">foo</span>
<span class="go">&lt;ActiveProperty foo=&#39;Empty!!&#39; [empty]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">User</span><span class="p">()</span><span class="o">.</span><span class="n">bar</span>
<span class="go">&lt;ActiveProperty bar=&#39;Nicht angegeben&#39; [empty]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">User</span><span class="p">()</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">capabilities</span>
<span class="go">capabilities(edit=True, delete=False)</span>
</pre></div>
</div>
<dl class="method">
<dt>
<code class="descname">getter</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#active_prop.getter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Descriptor to change the getter on a property.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">setter</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#active_prop.setter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Descriptor to change the setter on a property.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">deleter</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#active_prop.deleter"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Descriptor to change the deleter on a property.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">fake_setter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#active_prop.fake_setter"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">sipa.model.fancy_property.</code><code class="descname">connection_dependent</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sipa/model/fancy_property.html#connection_dependent"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A decorator to “deactivate” the property if the user’s not active.</p>
</dd></dl>

</div>
<div class="section" id="finance">
<h2><cite>.finance</cite><a class="headerlink" href="#finance" title="Permalink to this headline">¶</a></h2>
<p>Related to the information the user returns, we demand the following form
of the finance information:</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">sipa.model.finance.</code><code class="descname">BaseFinanceInformation</code><a class="reference internal" href="_modules/sipa/model/finance.html#BaseFinanceInformation"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A Class providing finance information about a user.</p>
<p>This class bundles informations such as whether the current user
is obliged to pay, the current balance, history, and the time of
the last update.  The balance is being provided as a
FancyProperty, so it can be used as a row.</p>
<p>For subclassing, implement the respective abstract
methods/properties.</p>
<dl class="attribute">
<dt>
<code class="descname">balance</code></dt>
<dd><p>The current balance as a
<a class="reference internal" href="ref/sipa.model.html#sipa.model.fancy_property.ActiveProperty" title="sipa.model.fancy_property.ActiveProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">ActiveProperty</span></code></a></p>
<p>If <a class="reference internal" href="ref/sipa.model.html#sipa.model.finance.BaseFinanceInformation.has_to_pay" title="sipa.model.finance.BaseFinanceInformation.has_to_pay"><code class="xref py py-attr docutils literal notranslate"><span class="pre">has_to_pay</span></code></a> is False, return an empty property with
the note that the user doesn’t have to pay.  Else, return the
balance formatted and styled (red/green) as money and mark
this property editable.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">raw_balance</code></dt>
<dd><p><strong>[Abstract]</strong> The current balance</p>
<p>If <a class="reference internal" href="ref/sipa.model.html#sipa.model.finance.BaseFinanceInformation.has_to_pay" title="sipa.model.finance.BaseFinanceInformation.has_to_pay"><code class="xref py py-meth docutils literal notranslate"><span class="pre">has_to_pay()</span></code></a> is False, this method will not be
used implicitly.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">has_to_pay</code></dt>
<dd><p><strong>[Abstract]</strong> Whether the user is obliged to pay.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">history</code></dt>
<dd><p><strong>[Abstract]</strong> History of payments</p>
<p>This method should return an iterable of a (datetime, int)
tuple.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">last_update</code></dt>
<dd><p><strong>[Abstract]</strong> The time of the last update.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">_abc_impl</code><em class="property"> = &lt;_abc_data object&gt;</em></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Sipa</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sipa.html"><cite>sipa</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="backends.html">Backends (Flask extension)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#implemented-backends">Implemented backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="#user">User</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fancy-property"><cite>.fancy_property</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="#finance"><cite>.finance</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ref/modules.html">Complete Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="backends.html" title="previous chapter">Backends (Flask extension)</a></li>
      <li>Next: <a href="ref/modules.html" title="next chapter">sipa</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Arbeitsgemeinschaft Dresdner Studentennetz (AG DSN), Lukas Juhrich.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/model.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>